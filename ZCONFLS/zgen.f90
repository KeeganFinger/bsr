!--------------------------------------------------------------------
      REAL(8) FUNCTION ZGEN(Q,L,N1,N2)
!--------------------------------------------------------------------
!     Coefficients of fractional parentage:   (l,q,v'S'L'|}l,q+1,vLS)
!     N1,N2 - index of v'L'S' and vLS terms in corresponding lists
!--------------------------------------------------------------------

      IMPLICIT REAL *8(A-H,O-Z)
      INTEGER Q
      Integer NP3(3),NP4(3),NP5(1), &
              IP2(3,3),IP3(3,3),IP4(3,1), &
              ND3(8),ND4(16),ND5(16),ND6(16),ND7(8),ND8(5),ND9(1), &
              ID2(5,8),ID3(8,16),ID4(16,16),ID5(16,16),ID6(16,8), &
              ID7(8,5),ID8(5,1),IND(10)
      DATA IND/12,13,14,22,23,24,25,26,27,28/

      ZGEN=1.0D0
      IF(Q.LT.0.OR.Q.GT.(4*L+1)) GO TO 21
      IF(Q.LE.1.OR.Q.EQ.(4*L+1)) RETURN
      if(L.eq.3) then
!       if(q.eq.2) ZGEN=gen_f3(N1,n2)
!       if(q.eq.3) ZGEN=gen_f4(N1,n2)
!       if(q.eq.4) ZGEN=gen_f5(N1,n2)
!       if(q.gt.4) Stop 'ZGEN: too many f-electrons'
       Return
      end if
      MET=0
      IN=10*L+Q
      DO 1 I=1,10
    1 IF(IND(I).EQ.IN) MET=I
      IF(MET.EQ.0) GO TO 21
      GO TO (11,12,13,14,15,16,17,18,19,20),MET
   11 R=IABS(IP2(N1,N2))
      ZGEN=DSQRT(R/NP3(N2))
      IF(IP2(N1,N2).LT.0) ZGEN=-ZGEN
      RETURN
   12 R=IABS(IP3(N1,N2))
      ZGEN=DSQRT(R/NP4(N2))
      IF(IP3(N1,N2).LT.0) ZGEN=-ZGEN
      RETURN
   13 R=IABS(IP4(N1,N2))
      ZGEN=DSQRT(R/NP5(N2))
      IF(IP4(N1,N2).LT.0) ZGEN=-ZGEN
      RETURN
   14 R=IABS(ID2(N1,N2))
      ZGEN=DSQRT(R/ND3(N2))
      IF(ID2(N1,N2).LT.0) ZGEN=-ZGEN
      RETURN
   15 R=IABS(ID3(N1,N2))
      ZGEN=DSQRT(R/ND4(N2))
      IF(ID3(N1,N2).LT.0) ZGEN=-ZGEN
      RETURN
   16 R=IABS(ID4(N1,N2))
      ZGEN=DSQRT(R/ND5(N2))
      IF(ID4(N1,N2).LT.0) ZGEN=-ZGEN
      RETURN
   17 R=IABS(ID5(N1,N2))
      ZGEN=DSQRT(R/ND6(N2))
      IF(ID5(N1,N2).LT.0) ZGEN=-ZGEN
      RETURN
   18 R=IABS(ID6(N1,N2))
      ZGEN=DSQRT(R/ND7(N2))
      IF(ID6(N1,N2).LT.0) ZGEN=-ZGEN
      RETURN
   19 R=IABS(ID7(N1,N2))
      ZGEN=DSQRT(R/ND8(N2))
      IF(ID7(N1,N2).LT.0) ZGEN=-ZGEN
      RETURN
   20 R=IABS(ID8(N1,N2))
      ZGEN=DSQRT(R/ND9(N2))
      IF(ID8(N1,N2).LT.0) ZGEN=-ZGEN
      RETURN
   21 WRITE(6,22) L,Q,N1,N2
   22 FORMAT(/5X,'Stop in ZGEN   L=',I2,'  Q=',I2,'  N1,N2=',2I2)
      STOP

      DATA NP3/1,18,2/,NP4/1,12,4/,NP5/15/, &
           IP2/0,1,0,  4,-9,-5,  0,1,-1/,   &
           IP3/0,1,0, -4,-3, 5,  0,-1,-3/,  &
           IP4/1,9,5/

      DATA ND3/   30,   15,   60,  140,   70,   5,  42,   2/
      DATA ND4/    1,    1,  360,   90,  280, 140, 210,  10, &
                 560,  840, 1680,  504, 1008,1680,  60,  10/ 
      DATA ND5/    5,    1,  150,  300,   50, 350, 700, 700, &
                2800, 2800,  700, 8400,18480, 420,1100, 550/
      DATA ND6/    1,    3,  270,  270,  210,2100, 630,  30, &
                1680, 2520, 5040,  378,33264,5040,1980, 330/
      DATA ND7/  210,  210,  140,  980, 1960, 490,5880, 770/
      DATA ND8/    1,  240,  560,  560,  336/
      DATA ND9/   45/

      DATA ID2/  0,  7, 15, -8,  0, &
                 0, -8,  0, -7,  0, &
                16, -9, -5,-21, -9, &
                 0,-49, 45, 21,-25, &
                 0, 28,-10,  7,-25, &
                 0, -1,  0,  4,  0, &
                 0,  0,-10, 21, 11, &
                 0,  0,  0, -1,  1/

      DATA ID3/   0,   0,   1,   0,   0,   0,   0,   0, &
                  0,   0,   0,   1,   0,   0,   0,   0, &
                -14, -64, 135, -35, -56, -56,   0,   0, &
                 25, -14,   0,  10, -25,  16,   0,   0, &
                -42,   0, 105,  45,  28,   0, -60,   0, &
                 42,   0,   0,  20,  63,   0,  15,   0, &
                -14,  49,   0,  60, -21, -21,  45,   0, &
                  0,   3,   0,   0,   0,   7,   0,   0, &
                120,   0,   0, 200,-105,   0,  -3,-132, &
                 16, -56, 315,  15, -14, 224,  90, 110, &
               -200,-448,   0, 120,-175,-112,-405, 220, &
                  0,   0, 189,- 25,  70,   0,  66,-154, &
                  0,   0,   0,  88, 385,   0,-507, -28, &
                  0,   0,   0, 200, 315,-560, 297, 308, &
                  0,   0,   0,   0,   5,  20,  -9,  26, &
                  0,   0,   0,   0,   0,   0,   3,   7 /
      DATA ID4/5*0,-2,3,9*0,   7*0,1,8*0, &
               0,0,14,25,30,15,10,0,-15,-16,-25,5*0, &
               0,0,-64,14,0,0,35,-75,0,-56,56,5*0, &
               6,0,-9,0,-5,4*0,-21,0,-9,4*0, &
               0,-14,-49,-14,45,-10,60,0,35,21,-21,-25,-11,45,0,0, &
               0,-56,0,126,0,90,60,0,35,0,189,0,99,45,0,0, &
               0,0,0,126,0,0,-135,-175,0,0,-84,0,0,180,0,0, &
               0,0,448,-200,-160,180,120,0,105,112,-175,-400,275,-405, &
               220,0, &
               0,0,0,360,0,-100,600,0,-525,0,-315,0,495,-9,-396,0, &
               0,0,-56,-16,0,0,-15,-175,0,224,14,0,0,-90,-110,0, &
               4*0,-800,-100,600,0,-7,1680,945,880,845,891,924,-728, &
               5*0,1452,968,0,-2541,0,4235,0,-1215,-5577,-308,-2184, &
               6*0,25,-105,0,0,-70,0,0,-66,154,0, &
               8*0,33,-220,55,220,-5,-99,286,182, &
               12*0,-45,99,231,-175/
      DATA ID5/4*0,1,11*0,   5*0,+1,-2,9*0,  &
               0,0,+14,+64,-45,+35,0,0,+56,0,+56,5*0, &
               0,0,+25,-14,0,+10,45,-90,-25,-45,+16,5*0, &
               0,0,+42,0,-35,-45,0,0,-28,0,0,+60,4*0, &
               -280,0,+210,0,0,+100,450,0,+315,175,0,+75,495,0,0,0, &
               -42,0,-14,+49,0,+60,-30,-135,-21,105,-21,+45,-33,75,0,0, &
               0,6,0,+3,0,0,0,5,0,0,+7,0,0,9,0,0, &
               0,0,+120,0,0,+200,-100,0,-105,-525,0,-3,495,0,-132,0, &
               0,0,-64,+224,-420,-60,0,0,+56,0,-896,-360,0,0,-440,0, &
               0,0,-200,-448,0,+120,540,480,-175,315,-112,-405,825, &
               1200,+220,0, &
               4*0,-63,+25,0,0,-70,0,0,-66,0,0,+154,0, &
               5*0,+968,4356,0,+4235,-7623,0,-5577,-3645,0,-308,-6552, &
               5*0,+200,-100,800,+315,-7,-560,+297,845,-880,+308,-728, &
               8*0,+55,99,+220,-99,-15,-660,+286,546, &
               11*0,+33,-45,0,+77,-175/
      DATA ID6/   0,   0,   7, -50,  15, -30, -20,   0, &
                 30,  -8,  50,   0,   0,   0,   0,   0, &
                  0,   0, -16, -14,   0,   0, -35,  75, &
                  0, -14, -56,   0,   0,   0,   0,   0, &
                  8,   0,  27,   0,  15,   0,   0,   0, &
                  0,  63,   0,  27,   0,   0,   0,   0, &
                  0,  56, -49,  56,  45,  40,-240,   0, &
               -140,  21,  84, -25,  44,-180,   0,   0, &
                  0,   0, 112, 200, -40,-180,-120,   0, &
               -105,  28, 175,-100,-275, 405,-220,   0, &
                  0,   0, -14,  16,   0,   0,  15, 175, &
                  0,  56, -14,   0,   0,  90, 110,   0, &
                  0,   0,   0,   0,-200, 100,-600,   0, &
                  7, 420,-945, 220,-845,-891,-924, 728, &
                  0,   0,   0,   0,   0,   0,   0,   0, &
                -33, -55, -55,  55,   5,  99,-286,-182  /
      DATA ID7/   0,   0,   1,   0,   0,   0,   0,   0, &
                -14, -64, -15, -35, -56, -56,   0,   0, &
               -126,   0, -35, 135,  84,   0,-180,   0, &
                 16, -56, -35,  15, -14, 224,  90, 110, &
                  0,   0, -21, -25,  70,   0,  66,-154  /
      DATA ID8/   1,   9,   5,  21,   9/

      END FUNCTION ZGEN
